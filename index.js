var canvas = document.querySelector("canvas");
var ctx = canvas.getContext('2d');

var tilesetContainer = document.querySelector(".tileset-container");
var tilesetSelection = document.querySelector(".tileset-container_selection");
var tilesetImage = document.querySelector("#tileset-source");

canvas.width = window.innerWidth;

var selection = [0, 0];
var tileSize = 32;

let scale = 1;

var originx = 0;
var originy = 0;

var isMouseDown = false;
var currentLayer = 0;
var layers = [
    //Bottom
    {
        //Structure is "x-y": ["tileset_x", "tileset_y"]
        //EXAMPLE: "1-1": [3, 4],
    },
];


//Select tile from the Tiles grid
tilesetContainer.addEventListener("mousedown", (event) => {
    selection = getCoordsUX(event);
    tilesetSelection.style.left = selection[0] * tileSize + "px";
    tilesetSelection.style.top = selection[1] * tileSize + "px";
    console.log('tilesetSelection.style.left', tilesetSelection.style.left)
});

//Handler for placing new tiles on the map
function addTile(mouseEvent) {
    var clicked = getCoords(mouseEvent);
    var key = clicked[0] + "-" + clicked[1];

    if (mouseEvent.shiftKey) {
        delete layers[currentLayer][key];
    } else {
        layers[currentLayer][key] = [selection[0], selection[1]];
    }
    draw();
}

//Bind mouse events for painting (or removing) tiles on click/drag
canvas.addEventListener("mousedown", () => {
    isMouseDown = true;
});
canvas.addEventListener("mouseup", () => {
    isMouseDown = false;
    // console.log(JSON.stringify(layers[0]))
});
canvas.addEventListener("mouseleave", () => {
    isMouseDown = false;
});
canvas.addEventListener("mousedown", addTile);
canvas.addEventListener("mousemove", (event) => {
    if (isMouseDown) {
        addTile(event);
    }
});

// // Handle mousenwheel zoom
ctx.canvas.onwheel =  function(e){
    e.preventDefault();

    var mousex = e.clientX - canvas.offsetLeft;
    var mousey = e.clientY - canvas.offsetTop;
    var wheel = e.wheelDelta/120;//n or -n

    //according to Chris comment
    var zoom = Math.pow(1 + Math.abs(wheel)/2 , wheel > 0 ? 1 : -1);

    ctx.translate(
        originx,
        originy
    );
    ctx.scale(zoom,zoom);
    ctx.translate(
        -( mousex / scale + originx - mousex / ( scale * zoom ) ),
        -( mousey / scale + originy - mousey / ( scale * zoom ) )
    );

    originx = ( mousex / scale + originx - mousex / ( scale * zoom ) );
    originy = ( mousey / scale + originy - mousey / ( scale * zoom ) );
    scale *= zoom;

    draw();
}
  

//Utility for getting coordinates of mouse click
function getCoords(e) {
    const { x, y } = e.target.getBoundingClientRect();

    let mouseX = e.clientX - x;
    let mouseY = e.clientY - y;

    var oX = Math.floor((originx / tileSize) )
    var oY = Math.floor((originy / tileSize) )

    finalX = Math.floor((mouseX / tileSize) / scale)
    finalY = Math.floor((mouseY / tileSize) / scale)

    return [
        finalX + oX,
        finalY + oY
    ];
}

//Utility for getting coordinates of mouse click
function getCoordsUX(e) {
    const { x, y } = e.target.getBoundingClientRect();
    const mouseX = e.clientX - x;
    const mouseY = e.clientY - y;

    return [Math.floor(mouseX / tileSize), Math.floor(mouseY / tileSize)];
}


//converts data to image:data string and pipes into new browser tab
const exportImage = () => {
    var data = canvas.toDataURL();
    var image = new Image();
    image.src = data;

    var w = window.open("");
    w.document.write(image.outerHTML);
}

//Reset state to empty
function clearCanvas() {
    layers = [{}, {}, {}];
    draw();
}

function zoomIt() {
    ctx.scale(2, 2);
    draw();
}

function setLayer(newLayer) {
    //Update the layer
    currentLayer = newLayer;

    //Update the UI to show updated layer
    var oldActiveLayer = document.querySelector(".layer.active");
    if (oldActiveLayer) {
        oldActiveLayer.classList.remove("active");
    }
    document.querySelector(`[tile-layer="${currentLayer}"]`).classList.add("active");
}

function draw() {
    var ctx = canvas.getContext("2d");
    ctx.clearRect(originx, originy, ctx.canvas.width/scale, ctx.canvas.height/scale);
    var size_of_crop = tileSize;

    layers.forEach((layer) => {
        Object.keys(layer).forEach((key) => {
            //Determine x/y position of this placement from key ("3-4" -> x=3, y=4)
            var positionX = Number(key.split("-")[0]);
            var positionY = Number(key.split("-")[1]);
            var [tilesheetX, tilesheetY] = layer[key];

            ctx.beginPath();
            ctx.rect(0, 0, 800, 600);
            ctx.stroke();

            ctx.drawImage(
                tilesetImage,
                tilesheetX * tileSize,
                tilesheetY * tileSize,
                size_of_crop,
                size_of_crop,
                positionX * tileSize,
                positionY * tileSize,
                size_of_crop,
                size_of_crop
            );
        });
    });
}


var defaultState = [{"9-2":[0,0],"10-2":[0,0],"10-3":[0,0],"11-3":[0,0],"12-3":[0,0],"13-3":[0,0],"13-4":[0,0],"14-4":[0,0],"15-4":[0,0],"15-5":[0,0],"14-5":[0,0],"14-6":[0,0],"13-7":[0,0],"13-8":[0,0],"12-8":[0,0],"12-9":[0,0],"13-9":[0,0],"14-9":[0,0],"15-9":[0,0],"16-9":[0,0],"17-9":[2,8],"18-9":[0,0],"18-8":[0,0],"18-7":[0,0],"18-6":[0,0],"19-6":[0,0],"19-5":[2,8],"20-6":[0,0],"21-6":[0,0],"21-7":[0,0],"21-8":[0,0],"21-9":[2,8],"20-9":[0,0],"20-10":[0,0],"20-11":[0,0],"19-11":[0,0],"19-12":[0,0],"18-12":[0,0],"18-13":[0,0],"17-13":[0,0],"17-14":[0,0],"17-15":[0,0],"16-15":[0,0],"18-15":[0,0],"18-14":[0,0],"19-14":[0,0],"19-13":[0,0],"20-13":[0,0],"20-12":[0,0],"16-14":[0,0],"15-15":[0,0],"14-15":[0,0],"13-16":[0,0],"12-16":[0,0],"12-17":[0,0],"11-17":[0,0],"11-18":[0,0],"16-13":[0,0],"17-12":[0,0],"18-11":[0,0],"18-10":[0,0],"19-10":[0,0],"19-9":[0,0],"17-10":[0,0],"16-10":[0,0],"16-11":[0,0],"15-12":[0,0],"14-13":[2,8],"14-14":[2,8],"15-13":[0,0],"16-12":[0,0],"15-11":[0,0],"17-11":[0,0],"15-10":[0,0],"14-11":[0,0],"13-12":[2,8],"12-13":[0,0],"12-14":[0,0],"13-13":[2,8],"14-10":[0,0],"15-8":[0,0],"16-8":[0,0],"16-7":[0,0],"16-6":[0,0],"15-6":[0,0],"14-7":[0,0],"11-9":[0,0],"11-10":[0,0],"10-10":[0,0],"10-11":[0,0],"14-8":[0,0],"15-7":[0,0],"17-5":[0,0],"18-4":[0,0],"17-4":[0,0],"16-5":[0,0],"13-6":[0,0],"12-6":[0,0],"11-7":[2,8],"9-8":[0,0],"8-8":[0,0],"9-7":[2,8],"10-7":[2,8],"10-8":[2,8],"10-9":[2,8],"9-9":[2,8],"11-8":[2,8],"12-7":[2,8],"11-6":[2,8],"11-5":[2,8],"12-5":[2,8],"13-5":[2,8],"12-4":[2,8],"11-4":[2,8],"10-5":[2,8],"9-5":[2,8],"9-4":[2,8],"9-3":[2,8],"10-4":[2,8],"8-4":[2,8],"8-3":[2,8],"8-2":[2,8],"8-1":[2,8],"9-1":[2,8],"10-1":[2,8],"11-1":[2,8],"11-2":[2,8],"12-2":[2,8],"13-2":[2,8],"14-2":[2,8],"14-3":[2,8],"15-3":[2,8],"16-3":[2,8],"16-4":[2,8],"17-3":[2,8],"18-3":[2,8],"19-3":[2,8],"19-4":[2,8],"20-4":[2,8],"20-5":[2,8],"21-5":[2,8],"22-5":[2,8],"22-6":[2,8],"22-7":[2,8],"22-8":[2,8],"22-9":[2,8],"21-10":[2,8],"21-11":[2,8],"21-12":[2,8],"21-13":[2,8],"21-14":[2,8],"20-14":[2,8],"20-15":[2,8],"19-15":[2,8],"19-16":[2,8],"18-16":[2,8],"17-16":[2,8],"16-16":[2,8],"15-16":[2,8],"14-16":[2,8],"14-17":[2,8],"13-17":[2,8],"13-18":[2,8],"12-18":[2,8],"12-19":[2,8],"12-20":[2,8],"11-20":[2,8],"11-19":[2,8],"10-19":[2,8],"10-18":[2,8],"10-17":[2,8],"10-16":[2,8],"11-16":[2,8],"11-15":[2,8],"12-15":[2,8],"13-15":[2,8],"13-14":[2,8],"15-14":[2,8],"14-12":[2,8],"13-11":[2,8],"12-11":[2,8],"12-10":[2,8],"13-10":[2,8],"11-11":[2,8],"11-12":[2,8],"11-13":[2,8],"10-13":[2,8],"10-12":[2,8],"9-12":[2,8],"9-11":[2,8],"9-10":[2,8],"18-5":[2,8],"17-6":[2,8],"17-7":[2,8],"17-8":[2,8],"19-7":[2,8],"20-7":[2,8],"20-8":[2,8],"19-8":[2,8],"111-52":[3,8],"110-52":[3,8],"109-52":[3,8],"108-52":[3,8],"106-52":[2,5],"105-52":[2,5],"104-52":[2,5],"102-52":[2,5],"101-53":[3,8],"100-53":[3,8],"100-54":[2,5],"100-55":[2,5],"100-56":[2,5],"100-58":[2,5],"100-59":[2,5],"100-60":[2,5],"100-61":[2,5],"100-62":[2,5],"101-62":[2,5],"103-62":[2,5],"105-62":[2,5],"106-62":[2,5],"108-62":[2,5],"110-62":[2,5],"111-62":[2,5],"112-62":[2,5],"112-61":[3,8],"113-61":[2,5],"114-61":[2,5],"114-60":[2,5],"115-60":[2,5],"115-59":[2,5],"115-58":[2,5],"115-57":[2,5],"115-56":[2,5],"114-56":[2,5],"114-55":[2,5],"114-54":[2,5],"114-53":[2,5],"114-52":[2,5],"113-52":[3,8],"112-52":[3,8],"107-52":[2,5],"107-51":[2,5],"106-51":[2,5],"105-51":[2,5],"104-51":[2,5],"103-51":[2,5],"103-52":[2,5],"105-53":[2,5],"106-53":[2,5],"107-53":[2,5],"108-53":[2,5],"108-54":[2,5],"108-55":[2,5],"107-55":[2,5],"107-56":[2,5],"106-56":[2,5],"106-55":[2,5],"105-55":[2,5],"104-55":[2,5],"104-54":[2,5],"104-53":[2,5],"103-53":[2,5],"105-54":[2,5],"106-54":[2,5],"107-54":[2,5],"110-54":[2,5],"110-55":[2,5],"109-55":[2,5],"109-56":[3,8],"110-57":[3,8],"111-57":[2,5],"111-56":[2,5],"111-55":[2,5],"112-55":[2,5],"111-54":[2,5],"110-56":[2,5],"101-56":[2,5],"102-56":[2,5],"101-57":[2,5],"102-57":[2,5],"103-57":[2,5],"100-57":[2,5],"101-58":[2,5],"102-58":[2,5],"103-58":[2,5],"104-58":[2,5],"104-57":[2,5],"103-56":[2,5],"104-59":[2,5],"105-58":[3,8],"106-58":[3,8],"107-58":[3,8],"108-58":[3,8],"108-57":[2,5],"107-57":[2,5],"106-57":[2,5],"105-57":[2,5],"108-59":[3,8],"109-58":[2,5],"110-58":[2,5],"110-59":[2,5],"110-60":[3,8],"111-59":[2,5],"112-59":[2,5],"112-58":[2,5],"113-58":[2,5],"113-59":[2,5],"114-59":[2,5],"114-58":[2,5],"114-57":[2,5],"113-57":[2,5],"112-57":[2,5],"103-60":[2,5],"104-60":[2,5],"105-60":[2,5],"106-60":[2,5],"107-60":[2,5],"107-61":[2,5],"107-62":[2,5],"107-63":[2,5],"108-63":[2,5],"109-63":[2,5],"109-62":[2,5],"109-61":[2,5],"108-61":[2,5],"106-61":[2,5],"105-61":[2,5],"104-61":[2,5],"103-61":[2,5],"102-61":[2,5],"101-61":[2,5],"102-62":[2,5],"102-63":[2,5],"104-62":[2,5],"105-63":[2,5],"106-63":[2,5],"108-64":[2,5],"109-64":[2,5],"110-64":[2,5],"111-64":[2,5],"112-64":[2,5],"111-63":[2,5],"113-62":[2,5],"114-62":[2,5],"115-61":[2,5],"113-55":[2,5],"101-54":[3,8],"101-55":[3,8],"102-55":[3,8],"102-54":[3,8],"103-54":[3,8],"103-55":[3,8],"102-53":[3,8],"101-52":[3,8],"113-53":[3,8],"112-53":[3,8],"111-53":[3,8],"109-53":[3,8],"112-56":[3,8],"113-56":[3,8],"111-58":[3,8],"108-56":[3,8],"107-59":[3,8],"106-59":[3,8],"105-59":[3,8],"108-60":[3,8],"109-60":[3,8],"109-59":[3,8],"111-60":[3,8],"112-60":[3,8],"113-60":[3,8],"111-61":[3,8],"110-61":[3,8],"43-26":[2,10],"44-26":[2,10],"44-27":[2,10],"45-27":[2,10],"46-27":[2,10],"46-28":[2,10],"47-28":[2,10],"48-28":[2,10],"48-29":[2,10],"49-29":[2,10],"49-30":[2,10],"50-30":[2,10],"51-31":[2,10],"52-31":[2,10],"52-32":[2,10],"53-32":[2,10],"53-33":[2,10],"54-33":[2,10],"55-33":[2,10],"55-34":[2,10],"56-34":[2,10],"56-35":[2,10],"57-35":[2,10],"58-35":[2,10],"58-36":[2,10],"57-37":[2,10],"57-38":[2,10],"56-38":[2,10],"55-38":[2,10],"55-39":[2,10],"54-40":[2,10],"54-41":[2,10],"53-41":[2,10],"53-42":[2,10],"52-42":[2,10],"52-43":[2,10],"53-43":[2,10],"53-44":[2,10],"54-44":[2,10],"55-44":[2,10],"56-45":[2,10],"57-45":[2,10],"58-45":[2,10],"59-45":[2,10],"60-45":[2,10],"61-45":[2,10],"62-45":[2,10],"62-46":[2,10],"63-46":[2,10],"64-46":[2,10],"65-46":[2,10],"66-46":[2,10],"67-46":[2,10],"68-46":[2,10],"68-45":[2,10],"68-44":[2,10],"67-44":[2,10],"67-43":[2,10],"67-42":[2,10],"67-41":[2,10],"67-40":[2,10],"67-39":[2,10],"67-38":[2,10],"67-37":[2,10],"67-36":[2,10],"67-35":[2,10],"67-34":[2,10],"67-33":[2,10],"67-32":[2,10],"67-31":[2,10],"67-30":[2,10],"67-29":[2,10],"66-28":[2,10],"65-29":[2,10],"64-30":[2,10],"64-31":[2,10],"63-31":[2,10],"63-32":[2,10],"62-32":[2,10],"62-33":[2,10],"61-33":[2,10],"61-34":[2,10],"60-34":[2,10],"60-33":[2,10],"59-33":[2,10],"59-32":[2,10],"58-31":[2,10],"57-30":[2,10],"56-29":[2,10],"56-28":[2,10],"55-28":[2,10],"54-28":[2,10],"54-27":[2,10],"53-27":[2,10],"52-26":[2,10],"52-25":[2,10],"51-25":[2,10],"51-24":[2,10],"50-24":[2,10],"50-23":[2,10],"49-23":[2,10],"49-22":[2,10],"48-22":[2,10],"48-21":[2,10],"48-20":[2,10],"47-20":[2,10],"47-19":[2,10],"46-20":[2,10],"46-21":[2,10],"45-22":[2,10],"45-23":[2,10],"44-23":[2,10],"44-24":[2,10],"43-24":[2,10],"43-25":[2,10],"68-43":[2,10],"68-42":[2,10],"68-41":[2,10],"68-40":[2,10],"68-39":[2,10],"68-38":[2,10],"68-37":[2,10],"68-36":[2,10],"68-35":[2,10],"68-34":[2,10],"68-33":[2,10],"68-32":[2,10],"68-31":[2,10],"68-30":[2,10],"67-28":[2,10],"65-28":[2,10],"67-45":[2,10],"66-45":[2,10],"65-45":[2,10],"64-45":[2,10],"63-45":[2,10],"59-44":[2,10],"58-44":[2,10],"57-44":[2,10],"57-43":[2,10],"56-43":[2,10],"55-43":[2,10],"54-42":[2,10],"51-43":[2,10],"51-44":[2,10],"50-44":[2,10],"52-44":[2,10],"56-44":[2,10],"60-46":[2,10],"61-46":[2,10],"55-45":[2,10],"51-42":[2,10],"76-42":[2,10],"77-42":[2,10],"78-42":[2,10],"79-42":[2,10],"79-43":[2,10],"79-44":[2,10],"78-44":[2,10],"77-44":[2,10],"76-44":[2,10],"75-44":[2,10],"75-43":[2,10],"74-43":[2,10],"74-42":[2,10],"75-42":[2,10],"77-43":[2,10],"76-43":[2,10],"78-43":[2,10],"80-30":[2,10],"79-30":[2,10],"79-31":[2,10],"79-32":[2,10],"78-32":[2,10],"78-33":[2,10],"77-34":[2,10],"77-35":[2,10],"76-35":[2,10],"76-36":[2,10],"76-37":[2,10],"75-37":[2,10],"75-38":[2,10],"78-34":[2,10],"79-33":[2,10],"62-54":[2,10],"61-54":[2,10],"60-54":[2,10],"59-54":[2,10],"58-54":[2,10],"64-54":[2,10],"66-54":[2,10],"67-54":[2,10],"68-54":[2,10],"69-54":[2,10],"70-54":[2,10],"71-54":[2,10],"65-54":[2,10],"63-54":[2,10],"57-54":[2,10],"55-54":[2,10],"54-54":[2,10],"53-54":[2,10],"52-54":[2,10],"56-54":[2,10],"58-55":[2,10],"59-55":[2,10],"60-55":[2,10],"61-55":[2,10],"57-55":[2,10],"55-55":[2,10],"54-55":[2,10],"53-55":[2,10],"89-53":[2,10],"88-53":[2,10],"87-53":[2,10],"86-53":[2,10],"85-53":[2,10],"84-53":[2,10],"83-53":[2,10],"82-53":[2,10],"83-54":[2,10],"84-54":[2,10],"85-54":[2,10],"86-54":[2,10],"87-54":[2,10],"88-54":[2,10],"89-55":[2,10],"90-55":[2,10],"91-55":[2,10],"92-55":[2,10],"93-55":[2,10],"94-55":[2,10],"93-54":[2,10],"92-53":[2,10],"91-53":[2,10],"91-52":[2,10],"90-52":[2,10],"89-52":[2,10],"88-52":[2,10],"30-17":[4,8],"29-18":[4,8],"29-19":[4,8],"28-19":[4,8],"28-20":[4,8],"28-21":[4,8],"28-22":[4,9],"27-22":[4,8],"27-23":[4,8],"26-24":[4,8],"26-25":[4,8],"25-25":[4,8],"25-26":[4,8],"25-27":[1,10],"25-28":[1,10],"30-16":[4,8],"29-17":[4,8],"27-20":[1,10],"27-21":[1,10],"26-23":[4,8],"25-24":[4,8],"24-25":[1,10],"24-26":[4,8],"23-26":[1,10],"23-27":[4,8],"22-27":[1,10],"22-28":[4,8],"21-28":[1,10],"21-29":[1,10],"20-29":[1,10],"22-29":[1,10],"23-28":[1,10],"24-28":[1,10],"26-27":[1,10],"27-26":[4,8],"27-27":[4,8],"26-28":[4,8],"25-29":[1,10],"25-30":[4,8],"24-31":[4,8],"24-32":[4,8],"23-32":[4,8],"22-33":[4,8],"22-34":[4,8],"21-35":[4,8],"20-36":[4,8],"20-37":[4,8],"19-37":[4,8],"19-38":[4,8],"18-39":[4,8],"19-39":[4,8],"21-38":[4,8],"22-38":[4,8],"23-38":[4,8],"24-38":[1,10],"25-37":[1,10],"26-37":[1,10],"28-37":[4,8],"29-37":[1,10],"29-36":[4,8],"30-36":[4,8],"31-36":[1,10],"32-36":[1,10],"33-36":[4,8],"34-36":[4,8],"34-35":[4,8],"35-35":[4,8],"36-34":[4,8],"36-33":[1,10],"35-33":[1,10],"34-33":[4,8],"33-33":[4,8],"32-33":[4,8],"30-33":[4,8],"29-33":[4,8],"28-33":[1,10],"27-33":[4,8],"27-32":[4,8],"28-32":[1,10],"29-31":[4,8],"30-29":[1,10],"31-28":[1,10],"33-27":[4,8],"34-26":[4,8],"35-26":[4,8],"36-26":[4,8],"36-25":[4,8],"37-25":[4,8],"38-24":[4,8],"38-23":[4,8],"39-22":[4,8],"39-21":[4,8],"40-21":[4,8],"38-21":[4,8],"37-21":[1,10],"36-22":[4,8],"35-22":[1,10],"34-22":[1,10],"33-22":[1,10],"33-21":[4,8],"34-19":[1,10],"35-18":[1,10],"36-17":[1,10],"38-15":[4,8],"40-15":[1,10],"40-14":[4,8],"41-13":[4,8],"42-12":[4,8],"42-11":[4,8],"43-11":[4,8],"43-10":[4,8],"44-10":[1,10],"44-9":[1,10],"43-9":[1,10],"42-9":[1,10],"41-10":[1,10],"40-10":[1,10],"39-10":[1,10],"37-10":[1,10],"36-10":[4,8],"35-10":[1,10],"34-11":[4,8],"33-11":[4,8],"32-11":[4,8],"31-11":[4,8],"30-11":[1,10],"30-12":[1,10],"29-12":[1,10],"29-13":[1,10],"29-14":[1,10],"29-15":[4,8],"29-16":[4,8],"30-15":[4,8],"31-14":[4,8],"31-13":[4,8],"32-13":[4,8],"32-12":[4,8],"33-12":[4,8],"33-13":[4,8],"34-13":[4,8],"35-12":[4,8],"34-12":[4,8],"33-14":[4,8],"32-14":[4,8],"32-15":[4,8],"34-14":[4,8],"35-13":[4,8],"36-12":[4,8],"32-16":[4,8],"31-17":[4,8],"30-18":[4,8],"32-17":[4,8],"34-16":[4,8],"35-15":[4,8],"36-14":[4,8],"37-14":[4,8],"37-13":[4,8],"38-13":[4,8],"38-12":[4,8],"33-16":[4,8],"32-18":[4,8],"31-19":[4,8],"30-19":[4,8],"33-18":[4,8],"34-17":[4,8],"36-16":[4,8],"37-15":[4,8],"38-14":[4,8],"39-13":[4,8],"40-13":[4,8],"40-12":[4,8],"39-14":[4,8],"37-16":[4,8],"35-16":[4,8],"40-11":[4,8],"41-11":[4,8],"41-12":[4,8],"39-11":[4,8],"38-11":[4,8],"37-11":[4,8],"36-11":[4,8],"38-10":[1,10],"37-12":[4,8],"31-16":[4,8],"33-15":[4,8],"34-15":[4,8],"35-14":[4,8],"36-15":[4,8],"33-17":[4,8],"32-19":[4,8],"31-20":[4,8],"30-21":[1,10],"29-20":[4,8],"28-23":[4,8],"28-24":[4,8],"28-25":[4,8],"27-25":[4,8],"26-26":[4,8],"29-25":[4,8],"24-33":[4,8],"25-31":[4,8],"26-30":[4,8],"26-29":[4,8],"27-29":[4,8],"27-28":[4,8],"21-34":[4,8],"28-28":[4,8],"28-27":[4,8],"23-33":[4,8],"21-36":[4,8],"22-36":[4,8],"22-35":[4,8],"23-35":[4,8],"24-35":[4,8],"23-36":[4,8],"21-37":[4,8],"24-36":[4,8],"25-35":[4,8],"26-35":[4,8],"27-35":[4,8],"25-36":[4,8],"26-36":[4,8],"27-36":[4,8],"28-36":[4,8],"29-35":[4,8],"30-35":[4,8],"28-35":[4,8],"31-34":[4,8],"32-34":[4,8],"33-34":[4,8],"34-34":[1,10],"30-34":[4,8],"29-34":[4,8],"28-34":[4,8],"27-34":[4,8],"26-34":[4,8],"31-35":[4,8],"25-34":[4,8],"24-34":[4,8],"23-34":[4,8],"26-31":[4,8],"27-30":[4,8],"28-29":[4,8],"30-28":[4,8],"29-29":[4,8],"28-30":[1,10],"27-31":[4,8],"26-32":[4,8],"30-27":[4,8],"31-27":[4,8],"29-28":[4,8],"33-24":[4,8],"37-20":[1,10],"38-20":[1,10],"38-19":[1,10],"39-19":[1,10],"35-23":[4,8],"34-23":[4,8],"34-24":[4,8],"36-23":[4,8],"35-24":[4,8],"34-25":[4,8],"37-22":[4,8],"38-22":[4,8],"33-25":[4,8],"32-25":[4,8],"41-20":[4,8],"42-20":[4,8],"42-19":[1,10],"43-19":[1,10],"44-19":[1,10],"41-21":[4,8],"39-23":[4,8],"37-24":[4,8],"35-25":[4,8],"33-26":[4,8],"32-27":[4,8],"31-26":[4,8],"31-24":[4,8],"30-25":[4,8],"29-26":[4,8],"28-26":[4,8],"32-23":[4,8],"31-23":[4,8],"30-24":[4,8],"29-24":[4,8],"32-24":[4,8],"33-23":[4,8],"18-38":[4,8],"17-39":[4,8],"16-39":[1,10],"16-40":[4,8],"15-41":[1,10],"17-40":[4,8],"20-38":[4,8],"22-37":[4,8],"23-37":[4,8],"24-37":[4,8],"25-38":[1,10],"24-39":[1,10],"23-39":[1,10],"22-40":[1,10],"21-40":[4,8],"21-41":[1,10],"20-41":[1,10],"19-41":[4,8],"18-41":[4,8],"17-41":[4,8],"17-42":[4,8],"16-42":[4,8],"15-42":[4,8],"14-43":[4,8],"13-43":[1,10],"12-43":[1,10],"12-44":[4,8],"11-44":[4,8],"11-45":[1,10],"10-45":[1,10],"13-42":[1,10],"14-42":[1,10],"22-39":[4,8],"21-39":[4,8],"20-40":[4,8],"19-40":[4,8],"20-39":[4,8],"33-10":[1,10],"34-10":[1,10],"36-9":[1,10],"37-9":[1,10],"41-9":[1,10],"45-9":[1,10],"46-9":[1,10],"45-10":[1,10],"44-11":[1,10],"44-12":[1,10],"43-12":[1,10],"43-13":[1,10],"42-13":[1,10],"42-14":[1,10],"41-14":[1,10],"39-15":[1,10],"39-16":[1,10],"38-16":[1,10],"38-17":[1,10],"37-17":[1,10],"36-18":[1,10],"33-19":[1,10],"33-20":[1,10],"32-20":[1,10],"31-21":[1,10],"30-22":[1,10],"31-22":[1,10],"32-22":[1,10],"36-21":[1,10],"40-19":[1,10],"41-19":[1,10],"45-19":[1,10],"44-20":[1,10],"43-21":[1,10],"43-22":[1,10],"42-22":[1,10],"42-23":[1,10],"41-24":[1,10],"40-25":[1,10],"39-25":[1,10],"39-26":[1,10],"38-26":[1,10],"37-26":[1,10],"37-27":[1,10],"36-27":[1,10],"35-27":[1,10],"34-27":[1,10],"34-28":[1,10],"33-28":[1,10],"32-28":[1,10],"31-29":[1,10],"30-30":[1,10],"29-30":[1,10],"28-31":[1,10],"29-32":[1,10],"30-32":[1,10],"31-32":[1,10],"32-32":[1,10],"33-32":[1,10],"34-32":[1,10],"35-32":[1,10],"36-32":[1,10],"37-32":[1,10],"32-10":[1,10],"31-10":[1,10],"30-10":[1,10],"28-15":[1,10],"28-16":[1,10],"28-17":[1,10],"27-17":[1,10],"27-18":[1,10],"27-19":[1,10],"26-21":[1,10],"26-22":[1,10],"25-22":[1,10],"25-23":[1,10],"24-23":[1,10],"24-24":[1,10],"23-25":[1,10],"22-26":[1,10],"21-27":[1,10],"20-28":[1,10],"19-29":[1,10],"19-30":[1,10],"20-30":[1,10],"21-30":[1,10],"23-29":[1,10],"24-27":[1,10],"24-29":[1,10],"24-30":[1,10],"23-30":[1,10],"23-31":[1,10],"22-32":[1,10],"22-31":[1,10],"21-31":[1,10],"21-32":[1,10],"20-32":[1,10],"20-33":[1,10],"19-34":[1,10],"19-35":[1,10],"18-35":[1,10],"18-36":[1,10],"18-37":[1,10],"17-37":[1,10],"17-38":[1,10],"16-38":[1,10],"15-40":[1,10],"14-41":[1,10],"11-43":[1,10],"10-44":[1,10],"9-44":[1,10],"9-45":[1,10],"8-45":[1,10],"8-46":[1,10],"9-46":[1,10],"10-46":[1,10],"12-45":[1,10],"13-45":[1,10],"13-44":[1,10],"14-44":[1,10],"15-44":[1,10],"15-43":[1,10],"16-43":[1,10],"17-43":[1,10],"18-43":[1,10],"18-42":[1,10],"19-42":[1,10],"22-41":[1,10],"23-40":[1,10],"26-38":[1,10],"25-39":[1,10],"25-40":[1,10],"25-41":[1,10],"26-40":[1,10],"26-39":[1,10],"27-39":[1,10],"28-39":[1,10],"28-38":[1,10],"29-38":[1,10],"30-37":[1,10],"31-37":[1,10],"33-35":[1,10],"35-34":[1,10],"37-33":[1,10],"38-32":[1,10],"38-31":[1,10],"39-31":[1,10]}]
// var defaultState = [{}]

tilesetImage.onload = function () {
    layers = defaultState;
    draw();
    setLayer(0);
}
tilesetImage.src = "https://assets.codepen.io/21542/TileEditorSpritesheet.2x_2.png";


(function () {
    // resize the canvas to fill browser window dynamically
    window.addEventListener('resize', resizeCanvas, false);

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        draw();
    }

    resizeCanvas();
})();
